/*
 *	    ____  ____  _____   ____________
 *	   / __ / __ /  _/ | / /_  __/ __
 *	  / /_/ / /_/ // //  |/ / / / / /_/ /
 *	 / ____/ _, _// // /|  / / / / _, _/
 *	/_/   /_/ |_/___/_/ |_/ /_/ /_/ |_|
 *
 *	Copyright Printr B.V. All rights reserved.
 *	This code is closed source and should under
 *	nu circumstances be copied or used in other
 *	applications than for Printr B.V.
 *
 */

var request = require('request');

function ApiProxy(formide) {
	this.formide = formide;
}

ApiProxy.prototype.call = function(method, url, data, token, next) {
	request({
		method: method,
		form: data,
		url: this.formide.config.apiUrl + url,
		strictSSL: false,
		auth: {
			bearer: token || ''
  		}
	}, function(error, response, body) {
		if(error) return next(JSON.parse(error));
		return next(null, JSON.parse(body));
	}.bind(this));
};

module.exports = ApiProxy;